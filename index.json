
[{"content":" Project Overview # In this project, I designed and deployed a secure virtual lab to simulate real-world network attacks. The goal was to configure Snort as a Network Intrusion Detection System (NIDS) to detect malicious traffic—specifically Pings, Port Scans, and Data Leaks—moving between a \u0026ldquo;Attacker\u0026rdquo; machine and a \u0026ldquo;Victim\u0026rdquo; machine.\nThis lab demonstrates how to gain deep visibility into internal network traffic using Deep Packet Inspection (DPI).\nTools and Configurations # I created a custom isolated network using VirtualBox to ensure traffic was isolated but visible to the IDS.\nGateway: pfSense (NAT + Internal Network)\nAttacker: Kali Linux (Internal Network)\nVictim: Windows 10 (Internal Network)\nIDS: Ubuntu Server 22.04 -Running Snort (Internal Network)\nThe Setup Phase # Enabling Visisbility(The \u0026ldquo;Wiretap\u0026rdquo;) # The most important configuration step was in VirtualBox. By default, VMs only see traffic meant for them. To make Snort act as a \u0026ldquo;wiretap,\u0026rdquo; I had to enable Promiscuous Mode: Allow All on the Ubuntu network adapter.\nSettings: Network \u0026gt; Adapter 1 \u0026gt; Advanced \u0026gt; Promiscuous Mode Value: Allow All Without this, Snort is blind to attacks against the Windows machine. Snort Configuration (snort.conf) # I configured /etc/snort/snort.conf to define my network environment, ensuring Snort knows what to protect (HOME_NET) and what to treat as hostile (EXTERNAL_NET) .\nsudo nano /etc/snort/snort.conf # Define local network ipvar HOME_NET 192.168.1.0/24 # Treat everything else as external ipvar EXTERNAL_NET !$HOME_NET Custom Detection Rules(local.rules) # I wrote three custom rules to test different detection capabilities:\nsudo nano /etc/snort/rules/local.rules Rule A: Detecting ICMP (Ping) Sweeps # alert icmp any any -\u0026gt; $HOME_NET any (msg:\u0026#34;ICMP Connection Attempt Detected\u0026#34;; sid:1000001; rev:1;) Rule B: Detecting SSH Port Scans # alert tcp any any -\u0026gt; $HOME_NET 22 (msg:\u0026#34;SSH Port Scan Detected\u0026#34;; sid:1000002; rev:1;) Rule C: Data Loss Prevention (DLP) # This rule uses Deep Packet Inspection to look for the specific string \u0026ldquo;confidential\u0026rdquo; inside TCP packets.\nalert tcp any any -\u0026gt; $HOME_NET any (msg:\u0026#34;CONFIDENTIAL DATA LEAK DETECTED\u0026#34;; content:\u0026#34;confidential\u0026#34;; nocase; sid:1000005; rev:1;) Challenges \u0026amp; Troubleshooting # Real labs never work perfectly on the first try. Here are the specific \u0026ldquo;Gotchas\u0026rdquo; I encountered and solved:\n1. The \u0026ldquo;Silent\u0026rdquo; Nmap Scan # Problem: I ran nmap -sn 192.168.1.0/24 to sweep the network, but Snort remained silent. Root Cause: On a local LAN, Nmap uses ARP (Address Resolution Protocol) to find hosts, not ICMP. My rule was strictly looking for ICMP packets. Solution: I forced Nmap to use IP packets:\nnmap -sn --send-ip 192.168.1.0/24 2. The SSH \u0026ldquo;Infinite Loop\u0026rdquo; # Problem: I was monitoring the logs via SSH using tail -f. When Snort detected an SSH scan, it wrote a log entry. That log text was sent over my SSH connection, which Snort detected as more SSH traffic, triggering another alert. Result: An infinite loop of scrolling alerts that flooded the console. Solution: I temporarily disabled the SSH rule (#) during the review phase to break the feedback loop.\n3. Windows Firewall Blocking # Problem: Scanning the Windows VM returned \u0026ldquo;Host Down\u0026rdquo;. Root Cause: Windows Defender Firewall blocks ICMP (Ping) by default. Solution: Used the -Pn flag in Nmap to skip the ping check and force the scan:\nnmap -Pn -p 22 192.168.1.101 The Results # To get real time results on snort, I used\nsudo tail -f /var/log/snort/snort.alert.fast Scenario 1: Detecting ICMP (ping) sweep # I pinged windows IP from kali and it triggered the ICMP rule immediately. I also ran a scan to sweep the network and the ICMP rule was triggered. Scenario 2: Detecting SSH Port Scans # I scanned the IDS server from Kali triggered the TCP rule immediately. Scenario 3: Catching Data Exfiltration # I used netcat to simulate a hacker stealing sensitive data.\nAttacker Command (Kali) nc 192.168.1.106 8080 confidential data test Lister command (snort) nc -l -p 8080 confidential data test Summary Log Ouputt # The summary of Log Output are as shown on the screenshot below: Conclusion # This project successfully demonstrated how to build a functional IDS for free using VirtualBox and Snort. The lab proved that Promiscuous Mode is essential for network monitoring and that writing custom rules allows for detecting specific threats—even \u0026ldquo;invisible\u0026rdquo; ones like specific keywords inside a packet.\n","date":"12 January 2026","externalUrl":null,"permalink":"/posts/lab/","section":"Posts","summary":"","title":"Building a Network Intrusion Detection System (IDS) Lab with Snort","type":"posts"},{"content":"","date":"12 January 2026","externalUrl":null,"permalink":"/categories/","section":"Categories","summary":"","title":"Categories","type":"categories"},{"content":"","date":"12 January 2026","externalUrl":null,"permalink":"/categories/cybersecurity/","section":"Categories","summary":"","title":"Cybersecurity","type":"categories"},{"content":"","date":"12 January 2026","externalUrl":null,"permalink":"/tags/firewall/","section":"Tags","summary":"","title":"Firewall","type":"tags"},{"content":"","date":"12 January 2026","externalUrl":null,"permalink":"/categories/home-lab/","section":"Categories","summary":"","title":"Home Lab","type":"categories"},{"content":"","date":"12 January 2026","externalUrl":null,"permalink":"/categories/linux/","section":"Categories","summary":"","title":"Linux","type":"categories"},{"content":"","date":"12 January 2026","externalUrl":null,"permalink":"/","section":"NATHAN","summary":"","title":"NATHAN","type":"page"},{"content":"","date":"12 January 2026","externalUrl":null,"permalink":"/tags/nids/","section":"Tags","summary":"","title":"NIDS","type":"tags"},{"content":"","date":"12 January 2026","externalUrl":null,"permalink":"/tags/pfsense/","section":"Tags","summary":"","title":"PfSense","type":"tags"},{"content":"","date":"12 January 2026","externalUrl":null,"permalink":"/posts/","section":"Posts","summary":"","title":"Posts","type":"posts"},{"content":"","date":"12 January 2026","externalUrl":null,"permalink":"/tags/snort/","section":"Tags","summary":"","title":"Snort","type":"tags"},{"content":"","date":"12 January 2026","externalUrl":null,"permalink":"/tags/","section":"Tags","summary":"","title":"Tags","type":"tags"},{"content":"","date":"6 November 2025","externalUrl":null,"permalink":"/posts/autopsy/","section":"Posts","summary":"","title":"Analyzing Non-volatile Data in Linux System","type":"posts"},{"content":"","date":"6 November 2025","externalUrl":null,"permalink":"/tags/autopsy/","section":"Tags","summary":"","title":"Autopsy","type":"tags"},{"content":"","date":"6 November 2025","externalUrl":null,"permalink":"/categories/digital-forensics/","section":"Categories","summary":"","title":"Digital Forensics","type":"categories"},{"content":"","date":"6 November 2025","externalUrl":null,"permalink":"/tags/system-analysis/","section":"Tags","summary":"","title":"System Analysis","type":"tags"},{"content":"","date":"6 November 2025","externalUrl":null,"permalink":"/categories/technical-writeup/","section":"Categories","summary":"","title":"Technical Writeup","type":"categories"},{"content":"","externalUrl":null,"permalink":"/authors/","section":"Authors","summary":"","title":"Authors","type":"authors"},{"content":"","externalUrl":null,"permalink":"/series/","section":"Series","summary":"","title":"Series","type":"series"}]